<!-- [links]: link -->

[docker]: https://www.docker.com/
[docker-repo]: https://hub.docker.com/repositories
[gcp-firewall-rules]: https://console.cloud.google.com/networking/firewalls/list
[gcp-vm]: https://console.cloud.google.com/compute/instances
[git]: www.github.com
[git-bash]: https://git-scm.com/downloads
[git-project]: www.github.com/SeanSnake93/Project_2
[site]: 35.246.12.58:5000
[trello]: https://trello.com/b/d1QbbJeG

# [Project_2][site]
QA Indevisual Project 2

Using Flask to create a project that will takes advantage of 4 or more Services to run a function.
The Services are to be built with the help of Docker and I am to demonstrate good practice through out the build process.

Submit by Date: 15th june

## Contents

* [Introduction](#Introduction)
    * [My Project Plan](#my-project-plan)
* [Planning Documentation](#planning-documentation)
    * [Trello](#trello)
    * [Enitiy Relationship Diagram](#enitiy-relationship-diagram)
    * [Risk Assesment](#risk-assesment)
* [Set-Up Process](#set-up-process)
    * [Creating Virtual Machine](#creating-virtual-machine)
        * [Opening ports](#Opening-ports)
        * [Importing Git Repository](#importing-git-repository)
        * [Remote Access](#remote-access)
        * [Create .gitignore](#create-gitignore)
        * [Creating a *Shebang* git push](#creating-a-Shebang-git-push)
    * [Set Up Docker](#set-up-docker)
* [Development](#development)
    * [Creating Developers Branch](#creating-developers-branch)
    * [Creating my app files](#creating-my-app-files)
        * [Test Driven Development](#test-driven-development)
            * [test_back_end.py](#project2/service_#/application/tests/test_back_end.py)
        * [Python Files](#python-files)
            * [app.py](#project2/service_#/app.py)
            * [__init __.py](#project2/service_#/application/__init-__.py)
            * [routes.py](#project2/service_#/application/routes.py)
        * [Web Page Creation](#web-page-creation)
            * [layout.html](#project2/service_1/application/templates/layout.html)
            * [home.html](#project2/service_1/application/templates/home.html)
            * [about.html](#project2/service_1/application/templates/about.html)
    * [Creating Docker Images](#creating-docker-images)
        * [Creating Version Control System](#creating-version-control-system)
        * [Uploading Images to Docker Hub](#uploading-images-to-docker-hub)
    * [Creating and Removing Containers](#creating-and-removing-containers)
    * [Setup Docker Compose](#setup-docker-compose)
        * [Creating a .yaml file](#creating-a-yaml-file)
            * [Project2/docker-compose.yaml](#project2/docker-compose.yaml)
        * [Running Docker Compose](#running-docker-compose)
        * [Dropping Docker Compose](#dropping-docker-compose)
* [Test Coverage](#test-coverage)
* [Index](#index)
    * [File Index](#file-index-(dev-level-1))
    * [Installations](#installations)


## Introduction

In this Project uploaded to Git I have used Python, Flask and Docker techniques to produce a Service based site. The site will generate a random selection from a Genre list and use it to filter out a Movie from my Collection and present it to the user. 

### My Project Plan

* To use each Service as a layer to the overall build process.
* A Services to select a Genre from a dynamic list.
* A Service using peramiters recived to filter a Movie from a dynamic list that matches.
* A dedicated Service used for compiling the Data recived into a presentable format.
* The final Serviced used for the front end interface to display the site and demonstrate my Project.

## Planning Documentation

### Trello

Link to visit my [Project_2 Trello Board][trello].

Using **MoSCoW** to break up the elements of the site into tasks that I...

- Must Have (`100`-`199`)
- Should Have (`200`-`299`)
- Could Have (`300`-`399`)
- Would Have (`400`-`499`)

...during the development of the project.

To indercate what MoSCoW level I will be focusing on, I will number each task with a clear indercator.<br />
This can be seen above in brackets, anything bellow 100 (`1`-`99`) will be planning documentation.

### Enitiy Relationship Diagram

As the project requires us to me to Services and not a database I will be using static data.<br />
Entities Generated by both Services will be displayed to the user.  

The total number of Lists created is "2", They are as follows...

**Genre**
> tag(s) (i.e. Action, Drama, Horror etc);

**Films**
> Film Name;
> Genre Tag(s);

### Risk Assesment

My risk Assesment will be taking into consideration any possibly damaging risks that could happen to my project.<br />
Looking at the indervisual step needed and the areas that they could go wrong in each.<br />
Using the Liklyhood and Impact of each risk to messure each risk, providing a Risk Level to each ranging from 1 to 10.<br />

Liklyhood = Imposible (1), Unlikly (2), Likly (3), Significant (4), Imminent (5)

Impact = Minimal (1), Low (2), Medium (3), High (4), Extreem (5)


| Risk              | Risk Statment | Response Stratogy                                                                   | Objectives                                        | Liklyhood   | Impact      | Risk Level |
| :---------------- | :------------ | :---------------------------------------------------------------------------------- | :------------------------------------------------ | :---------: | :---------: | :--------: |
| Risk 1            | Accepting     | How should I tackle it?                                                             | What I expect to happen?                          | Imminent    | Extreme     | 10         |
| Launch failure    | Reducing      | Monitor the changes made in trello regarding hosting.                               | The *site* should be accessable.                  | Likly       | High        | 7          |
| Service Failure   | Reducing      | Have key variables print their content to track it's progress.                      | Services delivers content as expected.            | Likly       | High        | 7          |
| Brake Service     | Reducing      | Use a Development Branch and only upload to master when the version is working.     | Always have a master version that is working.     | Significant | High        | 8          |
| Santex Error      | Undefined     | Keep the code simple and use good practice during development.                      | Project should run as expected.                   | Likly       | Medium      | 6          |
| Data Failure      | Undefined     | All data should match witn no typos, i.e name == name.                              | Services delivers content as expected.            | Unlikly     | Medium      | 5          |
| Link Failure      | Reducing      | Use the terminla to monitor Service responce.                                       | All links on the site deliver expected outcome.   | Unlikly     | Medium      | 5          |
| Retunrning Empty  | Reducing      | Using terminal prints and static data to fix outcome.                               | Pre-defined data to be visible on site.           | Likly       | Low         | 5          |
| Limited Lists     | Undefined     | Values used to randomise content in the list are not limited to its current length. | Intervention not needed when adding new content.  | Unlikly     | Extreme     | 7          |
| File Corruption   | Reducing      | Store backups of the project in a Docker Verson Controle system.                    | Version Controle each working maser upload.       | Unlikly     | High        | 6          |
| Testing failure   | Reducing      | Define tests before system development.                                             | Tests I define are to pass upon project creation. | Likly       | Medium      | 6          |
| Testing Coverage  | Reducing      | Tests should cover 80+% of the site or higher.                                      | All Tests should be a success.                    | Likly       | High        | 7          |
| User Error        | Reducing      | Have key variables print their content to track it's progress.                      | Services delivers content as expected.            | Likly       | Low         | 4          |
| GCP Cost          | Reducing      | Turn off Virtual Machine when not in use.                                           | Credit to be saved and longate the use of my GCP. | Unlikly     | High        | 6          |
| Underachive       | Reducing      | Use the metrics provided to assure the minimal marks have been aquired.             | Minimal project specification to be achived.      | Unlikly     | Extreme     | 7          |
| Overeaching       | Reducing      | Scale the project to meet to the brief first.                                       | A version of the minimal spec is archived.        | Likly       | Medium      | 6          |
| Health and Safety | Reducing      | Take breaks from the screen every couple of hours.                                  | Minimise the chance of headaches as fatigue.      | Likly       | High        | 7          |
| Stranded Data     | Reducing      | Data has no use within the project, only adding to its footprint size.              | Minimise the length of data and use of variables. | Unlikly     | Medium      | 5          |
| Project Theft     | Undefined     | All, if any sensative data are to be encripted and Virtual Machine is secure.       | The Project is secure.                            | Unlikly     | Extreme     | 7          |
| Knowlege          | Reducing      | Build the areas i know and reaserch areas I don't, ask questions about the project. | Have a clear understanding of thechnologies used. | Likly       | High        | 7          |
| Site Runs Slow    | Accepting     | Try to keep code efficent and consise in each Services.                             | For my project to load in a reasonable time.      | Likly       | Low         | 5          |
| Unfinished Document | Reducing    | Provide extensive documentation on the development of my project.                   | Documentation is clear and is followed easily.    | Unlikly     | High        | 6          |

## Set-Up Process
### Creating Virtual Machine

To create my Virtual Machine I used the [Google Cloud Platform][gcp-vm] and created an instance. <br />
The settings changed from the default where the Region (`eroupe-west2`) and Boot disk (`Ubuntu`, `Ubuntu 18.04 LTS`).

Once done I clicked `Create` to build my instance.

#### Opening ports

To enable ports on my VM I needed to edit the ports my machine has access to. This is done by using GCP's [Firewall Rules][gcp-firewall-rules] found in the `VCP Network` tab. In here I created Ports with the following settings.

| open-flask                                                     |
| :------------------------------------------------------------- |
| Targets<br />->  All instances in the network                  |
| Source filters<br />-> IP Ranges : 0.0.0.0/0                   |
| Protocols and ports<br />->  tcp : 5000                        |

| open-jenkins                                                   |
| :------------------------------------------------------------- |
| Targets<br />->  All instances in the network                  |
| Source filters<br />-> IP Ranges : 0.0.0.0/0                   |
| Protocols and ports<br />->  tcp : 8080                        |

Returning to the [Virtual Machine Instance's][gcp-vm] and entering my Virtual Machine to edit its setting. <br />
Scrolling down to Network Tags I enter the Port name's (i.e. open-flask) I wished to open and press space to add the port.<br />
When ports are added click save to enable the changes.

#### Importing Git Repository

Creating a [**Git repository**][git] to import over and hold my projects files. I created my repo with `Initialize this repository with a README` ticked (this was to not have an empty repo upon creation).

Once a New repo is made, clicking on `Clone or download` and copying the code inside / or copying the url link. 

Returning to the SSH terminal on my [Vitrual Machine][gcp-vm] I wish to copy my git repo over, so by using the following command...

| Code Input *- Bash*                                           | Output                                                     |
| :------------------------------------------------------------ | :--------------------------------------------------------- |
| `git clone https://github.com/SeanSnake93/Project_2.git`      | {uploaded}                                                 |

I am able to clone/copy my git repo over to the VM, as can be seen by using...

| Code Input *- Bash*                                           | Output                                                     |
| :------------------------------------------------------------ | :--------------------------------------------------------- |
| `ls`                                                          | "Project_2"                                                |

I can then enter this file by using... 

| Code Input *- Bash*                                           | Output                                                     |
| :------------------------------------------------------------ | :--------------------------------------------------------- |
| `cd Project_2/`                                               | :~/Project 2$                                              |

And to confirm it is my new repo, i should have a "read me" file inside my folder.

| Code Input *- Bash*                                           | Output                                                     |
| :------------------------------------------------------------ | :--------------------------------------------------------- |
| `ls`                                                          | "README.md"                                                |

#### Remote Access

In order to use my SSH remotly on **Visual Studio** I need to create a keygen. This can be created on the SSH terminal or by using [**Git Bash**][git-bash] on your local machine. By using the Git Bash terminal, the file will land directly on your system in the directory location Git Bash was launched.

Heading (on Windowns) to the `C:/Users/*LocalName*/.ssh` or `~/.ssh` directory and right clicking inside and selecting the option to `Git Bash Here`. Within the terminal **I uses**/use the following commands...

| Code Input *- Bash*                                               | Output                                                              |
| :---------------------------------------------------------------- | :------------------------------------------------------------------ |
| `ssh-keygen -t rsa -b 4096 -C "my@gitemail.com"`                  | "Enter a file in which to save the key (/c/Users/you/.ssh/id_rsa):" |
| {Enter Directory} *or* {**Press Enter to use default directory**} | "Enter passphrase (empty for no passphrase):"                       |
| {Enter passphrase} *or* {**Press Enter**}                         | "Enter same passphrase again:"                                      |
| {Re-enter passphrase} *or* {**Press Enter if left blank**}        | {Print out keys (id_rsa.pub; id_rsa)}                               |

Now I have 2 files in my `.ssh` directory called `id_rsa` and `id_rsa.pub`.

I can open the `id_rsa` using notepad to view the code needed or in the SSH Bash terminal use...

| Code Input *- Bash*                                           | Output                                                     |
| :------------------------------------------------------------ | :--------------------------------------------------------- |
| `cat id_rsa.pub`                                              | "Code output + = my@gitemail.com"                          |

With the code now visable, by returning to my [Virtual Machine][gcp-vm] and entering the `edit` setting of my VM, by scrolling down I can add my Public Key to the `SSH Key`. Clicking the link to drop down the menu and paist my code into the `SSH Keys` and saving it to allow me remote access to the server via my Private Key. It is now where if you wish to change the name of you e key you can. It can be changed later however, you will need to do this next step agin to change the new file location.

Now to allow my Local System access to find my VM I need to create a `config` file. while still in the `.ssh` directory and using **Git Bash** enter the following command.

| Code Input *- Bash*                                           | Output                                                     |
| :------------------------------------------------------------ | :--------------------------------------------------------- |
| `touch config`                                                | {Create file "config"}                                     |
| `vim config`                                                  | {vim/enter file "config"}                                  |

Inside this file I will need to define the Host, HostName, User, IdentityFile and declare what format. inside this file enter the following...

| Code Input *- Vim*                                            | Output                                                     |
| :------------------------------------------------------------ | :--------------------------------------------------------- |
| `i`                                                           | {Enter Insert Mode}                                        |
| `Host Project2`<br />->  `HostName {server IP}`<br />->  `User SeanSnake93`<br/>->  `IdentityFile ~/.ssh/keygen_name`<br /><br />`Host ssh`<br />->  `HostName ssh` |                                                            |
| `esc`                                                         | {Enter Command Mode}                                       |
| `:wq`                                                         | {Exit and Save}                                            |

With this file created I can now head to Visual Studio, (if `known_hosts` exists in the `.ssh` directory, delte this first then) click on the green icon situated in the bottom left of the program and select `Remote-SSH: Connect to Host...`.

As I have called my Host `Project2` I should see this name in my list and by clicking on it ill be asked what language to use, in this case `Linux`.

Now with a new window open, in the green box located in th ebottom left should say `SSH: Project2`. By clicking the Exploror tab and selecting `Open Drectory` I can have Visual Studio only show files within my project by clicking my project directory in the drop down path list and accepting.

#### Create .gitignore

By using this file I can tell git to not upload clutter files to the repo. This includes cashe files etc; so with remote access enabled and in my home directory, I can click on the "New File" icon and enter the name `.gitignore` and start editing.

| Code Input *- Visual Studio*                                  | Output                                                     |
| :------------------------------------------------------------ | :--------------------------------------------------------- |
| `/pycache/`<br />`*.pyc`<br />`/project2-venv/`<br />`/venv/`<br />`/.vscode/`<br />`chromedriver`                                                          |                                                            |
| `ctrl` + `s`                                                      | {Save Changes}                                             |

The `/project2-venv/` and `/venv/` files will relate to the Python3 install made later in the documentaion.

Now I have access via my external SSH on Visual Studio, I configured my git hib so make uploading easier and help with the Shebang next.

| Code Input *- Bash*                                           | Output                                                     |
| :------------------------------------------------------------ | :--------------------------------------------------------- |
| `git config --global credential.helper cache`                 | {Cache my credentials ~ removes the need of a password}    |
| `git config --global user.email "my@gitemail.com"`            | {configured Email}                                         |
| `git config --global user.name "SeanSnake93"`                 | {configured User}                                          |

#### Creating a *Shebang* git push

In the SSH terminal on Visual Studio I created a `.sh` (shell file) called `gitpush.sh`. The idea is that I can use this file to automate my `git push` process for me. By clicking the `Add File` icon I can create a file called `gitpush.sh` and begin to edit.

| Code Input *- Visual Studio*                                  | Output                                                     |
| :------------------------------------------------------------ | :--------------------------------------------------------- |
| `#!/usr/bun/env bash`<br /><br />`git add .`<br /><br />`git commit -m "Shebang Commit"`<br /><br />`git push` |                   |
| `ctrl` + `s`                                                      | {Save Changes}                                             |

Now the file has been created with the following commands inside I want to run it. The file as it stands hold has **Read** and **Write** permissions but to use this as a Shebang I need to enable the **Exicute** permissions.

This can be doen a couple of ways.<br />
By using the command...

| Code Input *- Bash*                                           | Output                                                     |
| :------------------------------------------------------------ | :--------------------------------------------------------- |
| `ls -l`                                                      | "-rw-rw-r-- 1 seansnake93 seansnake93 14382 May 27 17:14 README.md"<br />"-rw-rw-r-- 1 seansnake93 seansnake93  1845 May 27 17:45 gitpush.sh" |

I will recive a list of the files in my current directory with its Permissions (Read, Write, Exicute), Group and User.<br />
For referance the tabel bellow should help with the breakdown of Permissions...

| Permissions                                                   | Description                                                |
| :------------------------------------------------------------ | :--------------------------------------------------------- |
| d---------                                                    | Decares it is a directory.                                 |
| -rwx------                                                    | Read, Write and Exicute Privlages for Owner.               |
| ----rwx---                                                    | Read, Write and Exicute Privlages for Group.               |
| -------rwx                                                    | Read, Write and Exicute Privlages for all other users.     |

To allow the `gitpush.sh` to have **Execute** Permissions you can use the command...

| Code Input *- Bash*                                           | Output                                                     |
| :------------------------------------------------------------ | :--------------------------------------------------------- |
| `chmod +x ./gitpush`                                          | {Adds Execute Permissions to all Users}                    |

Now I can check to see if the file Permissions have changed...

| Code Input *- Bash*                                           | Output                                                     |
| :------------------------------------------------------------ | :--------------------------------------------------------- |
| `ls -l`                                                      | "-rw-rw-r-- 1 seansnake93 seansnake93 14382 May 27 17:14 README.md"<br />"-rw**x**rw**x**r-**x** 1 seansnake93 seansnake93  1845 May 27 17:45 gitpush.sh" |

I can see the Execute (`x`) Permissions is now present on the file. If I run this file in the SSH terminal in its directory location...

| Code Input *- Bash*                                           | Output                                                     |
| :------------------------------------------------------------ | :--------------------------------------------------------- |
| `./gitpush.sh`                                                | {All files pushed to git with "Shebang Commit" as comment} |

Now with the file working, I want to make this accessable to me anywhere in the directory. I did this by copying the file to the `bin`. this enables the file to be accessed using a smaller command than having to provide the full directory.

As the file is working I clicked on `New Folder` and called it `script` and in it another called `shebang` and moved the file into this location. This is to store my commands in the same place as a libary of custom scripts easy to find and edit if need be.

To copy the file into the bin and change the files Permissions to enable the Execute requires the following commands...

| Code Input *- Bash*                                           | Output                                                     |
| :------------------------------------------------------------ | :--------------------------------------------------------- |
| `sudo su`                                                     | {Change to "root" User}                                    |
| `cp /gitpush.sh /bin/gitpush.sh`                              | {Copy file into "/bin" location}                           |
| `chmod +x /bin/gitpush`                                       | {Adds Execute Permissions to all Users}                    |
| `sudo su seansnake93`                                         | {Return to seansnake93 User}                               |

Now that the file has been moved into `/bin` I am able to run a simple command anywhere in my directory to have the script run...

| Code Input *- Bash*                                           | Output                                                     |
| :------------------------------------------------------------ | :--------------------------------------------------------- |
| `gitpush`                                                     | {All files pushed to git with "Shebang Commit" as comment} |

> *This file has since been modified to ask for custom comments for commit's to git with yes/no prompts before* `git commit -m` *and* `git push`*.* 

### Set Up Docker

I have chose to use [Docker][docker] to enable me to create images, store within containers to then be held within a volume. 

To install Docker I used the following command...

| Code Input *- Bash*                                           | Output                                                     |
| :------------------------------------------------------------ | :--------------------------------------------------------- |
| `curl https://get.docker.com | sudo bash`                     | {Download and install Docker}                              |

In order to use any docker comands we will need to put `sudo docker ...` but, we can change this to remove the need of typing `sudo`. This can be achived by using the following command...

| Code Input *- Bash*                                           | Output                                                     |
| :------------------------------------------------------------ | :--------------------------------------------------------- |
| `sudo usermod -aG docker $(whoami)`                           | {Remove the need to put sudo befor docker}                 |

Having now run this I can run Docker's welcome screen without the need to include `sudo`...
> This may require a system restart or by creating a new group will enable Docker to run.

| Code Input *- Bash*                                           | Output                                                     |
| :------------------------------------------------------------ | :--------------------------------------------------------- |
| `newgrp docker`                                               | {Creates a new group}                                      |
| `docker run --rm hello-world`                                 | Hello from Docker!<br />This message shows that your installation appears to be working correctly.<br /><br />To generate this message, Docker took the following steps:<br />1. The Docker client contacted the Docker daemon.<br />2. The Docker daemon pulled the "hello-world" image from the Docker Hub.<br />(amd64)<br />3. The Docker daemon created a new container from that image which runs the<br />executable that produces the output you are currently reading.<br />4. The Docker daemon streamed that output to the Docker client, which it to your terminal.<br /><br />To try something more ambitious, you can run an Ubuntu container with:<br />$ docker run -it ubuntu bash<br />Share images, automate workflows, and more with a free Docker ID:<br />https://hub.docker.com/<br /><br />For more examples and ideas, visit:<br />https://docs.docker.com/get-started/ |

Now I know Docker is installed and working I no longer need the *Image* it created. To remove the file I need its IMAGE ID, to do this I generated a list of my current Images using...

| Code Input *- Bash*                                           | Output                                                     |
| :------------------------------------------------------------ | :--------------------------------------------------------- |
| `docker images`                                               | {Print out Images Table (seen Bellow)} |

> | REPOSITORY  | TAG    | IMAGE ID     | CREATED      | SIZE   |
> | :---------- | :----- | :----------- | :----------- | :----- |
> | hello-world | latest | bf756fb1ae65 | 4 months ago | 13.3kB |

Now this is done I can copy the IMAGE ID and add it to the Remove Image command, removing the *hello-world* file...

| Code Input *- Bash*                                           | Output                                                     |
| :------------------------------------------------------------ | :--------------------------------------------------------- |
| `docker rmi bf756fb1ae65`                                      | Untagged: hello-world:latest<br />Untagged: hello-world@sha256:6a65f928fb91fcfbc963f7aa6d57c8eeb426ad9a20c7ee045538ef34847f44f1<br />Deleted: sha256:bf756fb1ae65adf866bd8c456593cd24beb6a0a061dedf42b26a993176745f6b<br />Deleted: sha256:9c27e219663c25e0f28493790cc0b88bc973ba3b1686355f221c38a36978ac63 |

### Development

#### Creating Developers Branch

With the use of Visual Studio, by clicking on the option labled "Master" in the bottom left corner.
This then will show an option in the Visual Studio menu to "Create new branch...".

I called my other branch `Dev`, It is in here i will work before uploading content to the master. Only complete (Working) versions are allowed to be merged with the Master.

If a branch was not mady using this I could visit [my Git Hub repository][git-project] and create one or use the following command in the SSH terminal.

| Code Input *- Bash*                                           | Output                                                     |
| :------------------------------------------------------------ | :--------------------------------------------------------- |
| `git checkout -b Dev`                                         | {Created and moved to new branch called "Dev"}+            |

To confirm that I have entered the "Dev" branch I can use the following command to highlight (*) what my currently branch is...

| Code Input *- Bash*                                           | Output                                                     |
| :------------------------------------------------------------ | :--------------------------------------------------------- |
| `git branch`                                                  | * Dev<br />  master                                        |

#### Creating my app files

##### Test Driven Development

###### Project2/Service_#/application/tests/test_back_end.py

##### Python Files

###### Project2/Service_#/app.py

Creating the app file requires me to define the language used and inclue an import to mt app primaraly for the `__init__` file.Included in this is the port I wish to have access to it on. This must match the other time I call upon this port.

> **Service_1**
>> App port: `5000`

> **Service_2**
>> App port: `5001`

> **Service_3**
>> App port: `5002`

> **Service_4**
>> App port: `5003`

###### Project2/Service_#/application/__init __.py

Inside my __ init__ file I imported some of the flask features, Flask and request. In addition the that the app is to include the Flask name, this will help guide the app file and finaly import the routes file so links and functions are able to perform correctly.

###### Project2/Service_#/application/routes.py

Insided my routes file I have imported my app as to enable it to work with my site and some of the flask features, render_template and request, this is so that the site is capable of displaying a page with fields within it holding a value. In adition I have imported randrange from random to provide random selections from a list and requests, this is to enable to ability to request data from a diffrent service.

> **Service_1**
>> Url extention(s): `:5000/` or `:5000/home`
>> Available method(s): `GET` only
>> Requests Service_2 to return an answer in a text formate
>> Print the output from Service_2 in the terminal (to help track the data)
>> Return to the user a page with the template called "Project 2 Generator" and variable called movie holding the data retrived from Service 2.
>
>> Url extention(s): `:5000/about`
>> Available method(s): `GET` only
>> Return to the user a page with the template called "About Project 2".

> **Service_2**
>> Url extention(s): `:5001/generate`
>> Available method(s): `GET` only
>> Requests Service 3 to return an answer in a text formate
>> Print the output from Service_3 in the terminal (to help track the data)
>> Create a URL using the returned string from Service_3
>> Requests Service_4 to return using a filter recived by Service_3 an answer in a text formate
>> Print the output from Service_4 in the terminal (to help track the data)
>> Return a formated sting to Service_1 containing the date recived from Service_3 and Service_4

> **Service_3**
>> Url extention(s): `:5002/randomgenre`
>> Available method(s): `GET` only
>> Define list holding static data {genre}
>> Count the number of entries contained in the list and save the number in a variable
>> Print the number of entries in the terminal (to help track the data)
>> Return a random value from the genre list using the variable to send back to Service_2

> **Service_4**
>> Url extention(s): `:5003/<genre>`
>> Available method(s): `GET` and `POST`
>> Define an empty list
>> Define list holding static data {title, genre(s)}
>> From the list take each entry 1 by 1
>> In the entry is the data from Service_3 present (if not skip to next entry)
>> Split the contents up into its attributes {title} and {genre(s)}
>> From its attributes only take the first and add it to empty list
>> count the once empty list and save value in a variable
>> Return a random value from the appended list using the variable to send back to Service_2

#### Web Page Creation

###### Project2/Service_1/application/templates/layout.html

###### Project2/Service_1/application/templates/home.html

###### Project2/Service_1/application/templates/about.html

### Creating Docker Images

Now I have installed Docker on my Machine I will need to create an image of my indevisual services to begin version control.

First I Login to my docker account from within the SSh terminal...

| Code Input *- Bash*                                           | Output                                                     |
| :------------------------------------------------------------ | :--------------------------------------------------------- |
| `docker login`                                                | Username: <br />Password:                                  |

In order to create an Image I will first need to create a Dockerfile holding Instructions as to how I wish to create the file.

Entering the SSH terminal and creating the file using...

| Code Input *- Bash*                                           | Output                                                     |
| :------------------------------------------------------------ | :--------------------------------------------------------- |
| `touch Dockerfile`                                            | {Dockerfile created in current directory}                  |

> Note: The file must have a capital "D" in `Dockerfile`.

Entering the file I have included the following commands within my "Service_1" directory...

| Code Input *- Dockerfile*                                                                                                  |
| :------------------------------------------------------------------------------------------------------------------------- |
| `ARG PYTHON_VERSION=3.7`<br /><br />`FROM python:latest`<br /><br />`RUN mkdir /opt/services/`<br /><br />`COPY . /opt/services/`<br /><br />**`WORKDIR /opt/services/application/templates/`**<br /><br />**`RUN sed -i "s/{{PYTHON_VERSION}}/${PYTHON_VERSION}/g" home.html`**<br /><br />`WORKDIR /opt/services/`<br /><br />`RUN pip3 install -r requirements.txt`<br /><br />`EXPOSE 5000`<br /><br />`ENTRYPOINT ["/usr/local/bin/python3", "app.py"]` |

Above I have highlighted 3 lines in **bold**. With the use of a `--build-arg` in the `docker build` command I am able to change the version of Python I wish to use. Lines (9-11) however will not be included in my other services 2-4 `Dockerfile`, this is because they do not have web pages to host. For line 17, the `EXPOSE` port will chnage for each service. I have increased the port by 1 for each (5001, 5002, 5003) as to simplify the process.

#### Creating Version Control System

With my Dockerfile(s) created in each of my services I can now create my images to capture the current version.
To structure my Versions I will be creating a 3 tear code. The format is as follows... `service-{service Number}:{Development Version}.{Version Sprint}`

| Code Input *- Bash*                                                          | Output                                          |
| :--------------------------------------------------------------------------- | :---------------------------------------------- |
| `docker build -t service-1 --build-arg PYTHON_VERSION=3.7 ./Service_1/`      | {Creates an Image of Service 1}                 |
| `docker build -t service-2 ./Service_2/`                                     | {Creates an Image of Service 2}                 |
| `docker build -t service-3 ./Service_3/`                                     | {Creates an Image of Service 3}                 |
| `docker build -t service-4 ./Service_4/`                                     | {Creates an Image of Service 4}                 |

> The commands above will create the image with the tag latest. If a unique tag is to be included then use the following...
> "docker build -t service-2`:1.01` ./Service_#/" for example.

With my images now created I used the following to see their details...

| Code Input *- Bash*                                      | Output                                                          |
| :------------------------------------------------------- | :-------------------------------------------------------------- |
| `docker images`                                          | {Print out Container Table (seen Bellow)}                       |

#### Uploading Images to Docker Hub

To upload files to the Docker hun the file requires the addition of a username.
the file format is as follows... `{Docker Username}/{Image Name}:{Tag}`

To create this file we can run the following command(s) to copy an Image and change its name...

| Code Input *- Bash*                                      | Output                                                          |
| :------------------------------------------------------- | :-------------------------------------------------------------- |
| `docker tag service-1:latest seansnake93/service-1:1.01` | {Copy and Rename Image with new Tag}                            |
| `docker tag service-1:latest seansnake93/service-2:1.01` | {Copy and Rename Image with new Tag}                            |
| `docker tag service-1:latest seansnake93/service-3:1.01` | {Copy and Rename Image with new Tag}                            |
| `docker tag service-1:latest seansnake93/service-4:1.01` | {Copy and Rename Image with new Tag}                            |

With the new images created I can look at my images to see if all have been created. The new Images with the edited name and tag is ready to be push to my [Docker Hub Repositories][docker-repo] using the following commands...

| Code Input *- Bash*                                      | Output                                                          |
| :------------------------------------------------------- | :-------------------------------------------------------------- |
| `docker push seansnake93/service-1:1.01`                 | {Push new Image to Docker Repository}                           |
| `docker push seansnake93/service-2:1.01`                 | {Push new Image to Docker Repository}                           |
| `docker push seansnake93/service-3:1.01`                 | {Push new Image to Docker Repository}                           |
| `docker push seansnake93/service-4:1.01`                 | {Push new Image to Docker Repository}                           |

> My Images took a minute to upload and a couple more = to be visible in my Repositories. 

### Creating and Removing Containers

With each image built I wanted to test to see if they show details I expected to see by putting each within a "Container", done by using...

| Code Input *- Bash*                                     | Output                                                          |
| :------------------------------------------------------ | :-------------------------------------------------------------- |
| `docker run -d -p 5000:5000 --name service_1 service-1` | {Creates service_1 container}                                   |
| `docker run -d -p 5001:5001 --name service_2 service-2` | {Creates service_2 container}                                   |
| `docker run -d -p 5002:5002 --name service_3 service-3` | {Creates service_3 container}                                   |
| `docker run -d -p 5003:5003 --name service_4 service-4` | {Creates service_4 container}                                   |

> the `-d` detaches the command from the terminal, allowing foe me to use the terminla after activating the "Container".

With my Containers created, by using the following command I get to see a table containing the details of each "Active Container"...

| Code Input *- Bash*                                      | Output                                                          |
| :------------------------------------------------------- | :-------------------------------------------------------------- |
| `docker ps`                                              | {Print out Active Container Table (seen Bellow)}                |

> | CONTAINER ID | IMAGE      | COMMAND                | CREATED        | STATUS       | PORTS                  | NAMES     |
> | :----------- | :--------- | :--------------------- | :------------- | :----------- | :--------------------- | :-------- |
> | aaaa         | ver-1.1.01 | "/usr/local/bin/pyth…" | 23 minutes ago | Up 5 minutes | 0.0.0.0:5000->5000/tcp | service_1 |
> | bbbb         | ver-2.1.01 | "/usr/local/bin/pyth…" | 21 minutes ago | Up 5 minutes | 0.0.0.0:5001->5001/tcp | service_2 |
> | cccc         | ver-3.1.01 | "/usr/local/bin/pyth…" | 20 minutes ago | Up 5 minutes | 0.0.0.0:5002->5002/tcp | service_3 |
> | dddd         | ver-4.1.01 | "/usr/local/bin/pyth…" | 18 minutes ago | Up 5 minutes | 0.0.0.0:5003->5003/tcp | service_4 |

>> The "Containter ID" will be made up of a random asort of letters and numbers. But to keep my documentation clear I will use the simple ID's.

if a "Container" fails to provide a port it may not show in this list. By using the following command, I am able to so all "Containers" within my project...

| Code Input *- Bash*                                      | Output                                                          |
| :------------------------------------------------------- | :-------------------------------------------------------------- |
| `docker ps -a`                                           | {Show all containers}                                           |

If the "Container" exists but, is not active some of the code my be wrong with the Dockerfile or Service files.

For more details abou the debug I can use the following to print it out on the display...

| Code Input *- Bash*                                      | Output                                                          |
| :------------------------------------------------------- | :-------------------------------------------------------------- |
| `docker logs aaaa`                                       | {Debug container(s) service_1}                                  |

When happy with my containers, I removed them to begin setting up "Docker Compose", This requires me to stop them before removing each "Container", this is done by using...

| Code Input *- Bash*                                      | Output                                                                     |
| :------------------------------------------------------- | :------------------------------------------------------------------------- |
| `docker stop service_1`                                  | {stop container called service_1}                                          |
| `docker stop service_2 service_3 service_4`              | {stop container(s) called service_2 + service_3 + service_4}               |
| `docker rm service_1`                                    | {Remove container called service_1}                                        |
| `docker rm service_2 service_3 service_4`                | {Remove container(s) called service_2 + service_3 + service_4}             |

### Setup Docker Compose

Install commands

| Code Input *- Bash*                                      | Output                                                          |
| :------------------------------------------------------- | :-------------------------------------------------------------- |
| `sudo apt update`                                        | {This will make sure jq and curl are available to installed}    |
| `sudo apt install -y curl jq`                            | {install curl and jq}                                           |
| `version=$(curl -s https://api.github.com/repos/docker/compose/releases/latest | jq -r '.tag_name')` | {Get the latest version} |
| `sudo curl -L "https://github.com/docker/compose/releases/download/${version}/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose` | {send the file to the bin (so we can call it as a function)} |
| `sudo chmod +x /usr/local/bin/docker-compose`            | {Make the file moved into the bin a executable file}            |


#### Creating a .yaml file

###### Project2/docker-compose.yaml

#### Running Docker Compose

#### Dropping Docker Compose

## Test Coverage

## Index

### Development 1 File Index

Project2/<br />
Project2/**docker-compose.yaml**<br />
Project2/**README.md**<br />
Project2/nginx/<br />
Project2/nginx/**nginx.conf**<br />
Project2/Service_1/<br />
Project2/Service_1/**app.py**<br />
Project2/Service_1/**Dockerfile**<br />
Project2/Service_1/**requirements.txt**<br />
Project2/Service_1/application/<br />
Project2/Service_1/application/**__init__.py**<br />
Project2/Service_1/application/**routes.py**<br />
Project2/Service_1/application/static/<br />
Project2/Service_1/application/templates/<br />
Project2/Service_1/application/templates/**about.html**<br />
Project2/Service_1/application/templates/**home.html**<br />
Project2/Service_1/application/templates/**layout.html**<br />
Project2/Service_1/application/tests/<br />
Project2/Service_1/application/tests/**__init__.py**<br />
Project2/Service_1/application/tests/**test_back_end.py**<br />
Project2/Service_2/<br />
Project2/Service_2/**app.py**<br />
Project2/Service_2/**Dockerfile**<br />
Project2/Service_2/**requirements.txt**<br />
Project2/Service_2/application/<br />
Project2/Service_2/application/**__init__.py**<br />
Project2/Service_2/application/**routes.py**<br />
Project2/Service_2/application/tests/<br />
Project2/Service_2/application/tests/**__init__.py**<br />
Project2/Service_2/application/tests/**test_back_end.py**<br />
Project2/Service_3/<br />
Project2/Service_3/**app.py**<br />
Project2/Service_3/**Dockerfile**<br />
Project2/Service_3/**requirements.txt**<br />
Project2/Service_3/application/<br />
Project2/Service_3/application/**__init__.py**<br />
Project2/Service_3/application/**routes.py**<br />
Project2/Service_3/application/tests/<br />
Project2/Service_3/application/tests/**__init__.py**<br />
Project2/Service_3/application/tests/**test_back_end.py**<br />
Project2/Service_4/<br />
Project2/Service_4/**app.py**<br />
Project2/Service_4/**Dockerfile**<br />
Project2/Service_4/**requirements.txt**<br />
Project2/Service_4/application/<br />
Project2/Service_4/application/**__init__.py**<br />
Project2/Service_4/application/**routes.py**<br />
Project2/Service_4/application/tests/<br />
Project2/Service_4/application/tests/**__init__.py**<br />
Project2/Service_4/application/tests/**test_back_end.py**

### Installations

- sudo apt update
- sudo apt install tree
- sudo apt install python3
- sudo apt install python3-pip
- sudo apt install python3-venv
- python3 -m venv project2-venv
- . project2-venv/bin/activate
- **venv** pip install flask 
    - Flask==1.1.2
    - Jinja2==2.11.2
- **venv** pip3 install pytest 
    - pytest==5.4.2
- **venv** pip3 install pytest-cov 
    - pytest-cov==2.8.1
- **venv** pip3 install flask-testing 
    - Flask-Testing==0.8.0
    - Werkzeug==1.0.1
- WILL HAVE TO INCLUDE THE DOCKER and DOCKER COMPOSE INSTALLATION




################## END of 1.01 ############################################


#### Defining Exports

Creating a new [Virtual Machine][gcp-vm] on GCP to host my site on a Jenkins CI and be used as a Master node and Development Server. This set up will run changes made to my development branch and when pushed to maset will then be built on my Project_2 Server.

Having Created the VM I ran the following command to define my Master node...

| Code Input *- Bash*                                           | Output                                                     |
| :------------------------------------------------------------ | :--------------------------------------------------------- |
| `docker swarm init`                                           | {Initilising Master node}                                  |

With the master now defined i return to my Project 2


docker swarm join --token [TOKEN] [IP_ADDRESS]:[PORT]
<!--  Creating a Worker node -->

docker swarm join-token worker
<!--  Recover tocken -->

docker service create --name nginx --publish 80:80 nginx:latest
<!--  Recover nginx image -->

curl http://[PRIVATE_IP_ADDRESS]
curl http://[PRIVATE_IP_ADDRESS]
<!-- Add to cluster 

curl http://swarm-master
curl http://swarm-worker

-->